# Karting Booking Bot

Telegram бот для бронирования заездов на картинг.

## Функционал

- Бронирование заездов на картинг
- Максимум 5 человек на заезд
- Длительность заезда: 10 минут
- Время работы: 12:00 - 18:00
- Стоимость: 500 рублей (фиксированная)
- Интеграция с Юкасса для оплаты

## Установка

1. Клонируйте репозиторий
2. Установите зависимости: `npm install`
3. Настройте переменные окружения в `.env`:
   - `TELEGRAM_BOT_TOKEN` - токен Telegram бота
   - `DATABASE_URL` - URL базы данных PostgreSQL (или используйте параметры в db.ts)
   - `YOOKASSA_SHOP_ID` - ID магазина Юкасса
   - `YOOKASSA_SECRET_KEY` - секретный ключ Юкасса
4. Запустите базу данных: `docker-compose up -d`
5. Соберите проект: `npm run build`
6. Запустите бота: `npm start`

Для разработки: `npm run dev`

## Web App

Бот поддерживает Telegram Web App для удобного бронирования с календарем и авторизацией по номеру телефона.

### Деплой на GitHub Pages

Web App настроен для автоматического деплоя на GitHub Pages:
- Файлы в папке `webapp/` деплоятся через GitHub Actions
- После пуша в main ветку, Web App будет доступен по URL: `https://your-username.github.io/repo-name`
- Обновите URL в `src/index.ts` в кнопке Web App

### Функции Web App

- Календарь для выбора даты (input type="date")
- Авторизация: проверка номера телефона через Telegram API
- Просмотр личных бронирований с возможностью отмены
- Прямая отправка данных бронирования в бот
- API интеграция для управления бронированиями

### API Endpoints

- `GET /api/bookings?userId=<id>` - получить бронирования пользователя
- `POST /api/cancel` - отменить бронирование (body: {bookingId, userId})

## Структура проекта

- `src/index.ts` - основной файл бота
- `src/db.ts` - операции с базой данных
- `src/payment.ts` - интеграция с Юкасса
- `schema.sql` - схема базы данных
- `docker-compose.yml` - конфигурация Docker для БД

## Команды бота

- `/start` - приветствие
- `/book` - начать бронирование

Бот ведет пользователя через шаги: выбор даты, времени, количества человек, подтверждение и оплата.